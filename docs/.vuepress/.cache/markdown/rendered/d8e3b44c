{"content":"<h2 id=\"项目基础结构\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#项目基础结构\"><span>项目基础结构</span></a></h2>\n<div class=\"hint-container tip\">\n<p class=\"hint-container-title\">提示</p>\n<p>项目结构未使用微服务架构，以目前个人的项目来</p>\n</div>\n<div class=\"vp-file-tree\"><FileTreeNode expanded type=\"folder\" filename=\"api\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:folder-type-api\" /></template><template #comment>// 存放 api 文件</template><FileTreeNode type=\"file\" filename=\"user.api\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-file\" /></template>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"const\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><template #comment>// 一些常量</template><FileTreeNode expanded type=\"folder\" filename=\"ec\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><template #comment>// 存放错误枚举</template><FileTreeNode type=\"file\" filename=\"common.go\" :level=\"2\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n<FileTreeNode type=\"file\" filename=\"user.go\" :level=\"2\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"docs\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:folder-type-docs\" /></template><template #comment>// 文档内容</template><FileTreeNode type=\"file\" filename=\"main.json\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-json\" /></template><template #comment>// goctl 生成的swagger数据</template>\n</FileTreeNode>\n<FileTreeNode type=\"file\" filename=\"swagger.html\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-html\" /></template><template #comment>// 自定义随项目启动的文件</template>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"etc\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><template #comment>// 由 goctl 生成，为配置文件</template><FileTreeNode type=\"file\" filename=\"main.yaml\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-light-yaml\" /></template>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"http\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><template #comment>// 相关 http 后缀文件， 用于接口请求测试</template><FileTreeNode type=\"file\" filename=\"login.http\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-file\" /></template>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"internal\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><template #comment>// goctl 生成，包含各类逻辑等文件</template><FileTreeNode expanded type=\"folder\" filename=\"config\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:folder-type-config\" /></template><FileTreeNode type=\"file\" filename=\"config.go\" :level=\"2\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"handler\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><FileTreeNode expanded type=\"folder\" filename=\"user\" :level=\"2\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><FileTreeNode type=\"file\" filename=\"getuserinfohandler.go\" :level=\"3\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n<FileTreeNode type=\"file\" filename=\"userloginhandler.go\" :level=\"3\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode type=\"file\" filename=\"routes.go\" :level=\"2\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"logic\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><FileTreeNode expanded type=\"folder\" filename=\"user\" :level=\"2\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><FileTreeNode type=\"file\" filename=\"getuserinfologic.go\" :level=\"3\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n<FileTreeNode type=\"file\" filename=\"userloginlogic.go\" :level=\"3\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"svc\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><FileTreeNode type=\"file\" filename=\"servicecontext.go\" :level=\"2\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"types\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:folder-type-typings\" /></template><FileTreeNode type=\"file\" filename=\"types.go\" :level=\"2\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"model\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:folder-type-model\" /></template><template #comment>//数据库文件</template><FileTreeNode type=\"file\" filename=\"user.go\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"templates\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:folder-type-template\" /></template><template #comment>// 存放自定义的 goctl 模板文件</template><FileTreeNode expanded type=\"folder\" filename=\"api\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:folder-type-api\" /></template><FileTreeNode type=\"file\" filename=\"...\" :level=\"2\">\n\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"docker\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><FileTreeNode type=\"file\" filename=\"...\" :level=\"2\">\n\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"geteway\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><FileTreeNode type=\"file\" filename=\"...\" :level=\"2\">\n\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"kube\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><FileTreeNode type=\"file\" filename=\"...\" :level=\"2\">\n\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"model\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:folder-type-model\" /></template><FileTreeNode type=\"file\" filename=\"...\" :level=\"2\">\n\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"mongo\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><FileTreeNode type=\"file\" filename=\"...\" :level=\"2\">\n\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"newapi\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><FileTreeNode type=\"file\" filename=\"...\" :level=\"2\">\n\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"rpc\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><FileTreeNode type=\"file\" filename=\"...\" :level=\"2\">\n\n</FileTreeNode>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"utils\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:folder-type-tools\" /></template><template #comment>// 自定义功能</template><FileTreeNode type=\"file\" filename=\"init_db.go\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n<FileTreeNode type=\"file\" filename=\"jwt.go\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode type=\"file\" filename=\"Dockerfile\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-docker\" /></template>\n</FileTreeNode>\n<FileTreeNode type=\"file\" filename=\"README.md\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"flat-color-icons:info\" /></template>\n</FileTreeNode>\n<FileTreeNode type=\"file\" filename=\"go.mod\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-file\" /></template>\n</FileTreeNode>\n<FileTreeNode type=\"file\" filename=\"go.sum\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-file\" /></template>\n</FileTreeNode>\n<FileTreeNode type=\"file\" filename=\"main.go\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode></div>\n<h2 id=\"生成api代码\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#生成api代码\"><span>生成api代码</span></a></h2>\n<h3 id=\"api-文件基本使用\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#api-文件基本使用\"><span>api 文件基本使用</span></a></h3>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>使用 <code v-pre>goctl api go </code> 来生成代码，会跳过已经生成的文件，所以如果新增接口、类型，需要删除无需手动编辑的文件，如 <code v-pre>types</code> 目录、主文件（路由注册）等，这个代表生成的类型等，即需要重新生成的删除，不需要的保留</p>\n<p>比如一个 <code v-pre>user</code> 服务，你修改了某个接口的类型和接口定义，你需要删除 <code v-pre>handler</code> 、<code v-pre>types</code> ，然后重新执行 <code v-pre>goctl api go</code> 的命令，<code v-pre>logic</code> 逻辑代码已经改过，不要删除，精准情况下，只删除对应的文件也行</p>\n</div>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p><code v-pre>api</code> 文件中，只能有对应名称的 <code v-pre>service</code> ，创建多个 <code v-pre>service</code> 必须是同名的，即使使用 <code v-pre>import</code> 导入其他 <code v-pre>api</code> 文件也不行</p>\n</div>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>在 <code v-pre>api</code> 文件中，可以在 <code v-pre>@server</code> 中指定 <code v-pre>group</code> 参数，生成的 <code v-pre>logic</code> 和 <code v-pre>handler</code> 可以使用不同的文件夹存在，可以进行不同分类</p>\n</div>\n<p>在你的项目目标文件夹中，创建一个 <code v-pre>api</code> 文件，也可以使用 <code v-pre>goctl api template -o {{目标文件夹}}\\{{文件名}}.api</code> 来生成一个 <code v-pre>api</code> 文件</p>\n<p>官方示例：</p>\n<div class=\"code-block-title\" data-title=\"api文件\"><div class=\"code-block-title-bar\"><span class=\"title\">api文件</span></div><div class=\"language-text line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"text\" style=\"--shiki-light:#4c4f69;--shiki-dark:#c6d0f5;--shiki-light-bg:#eff1f5;--shiki-dark-bg:#303446\"><pre class=\"shiki shiki-themes catppuccin-latte catppuccin-frappe vp-code\" v-pre=\"\"><code class=\"language-text\"><span class=\"line\"><span>syntax = \"v1\"</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>// 这里的主要用在 swagger 文件显示</span></span>\n<span class=\"line\"><span>info (</span></span>\n<span class=\"line\"><span>    title:   \"api 文件完整示例写法\"</span></span>\n<span class=\"line\"><span>    desc:    \"演示如何编写 api 文件\"</span></span>\n<span class=\"line\"><span>    author:  \"keson.an\"</span></span>\n<span class=\"line\"><span>    date:    \"2022 年 12 月 26 日\"</span></span>\n<span class=\"line\"><span>    version: \"v1\"</span></span>\n<span class=\"line\"><span>)</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>// 使用 type 定义请求结构体</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>type UpdateReq {</span></span>\n<span class=\"line\"><span>    Arg1 string `json:\"arg1\"`</span></span>\n<span class=\"line\"><span>}</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>type ListItem {</span></span>\n<span class=\"line\"><span>    Value1 string `json:\"value1\"`</span></span>\n<span class=\"line\"><span>}</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>// 可以使用 example 在生成 swagger 时给出一些数据的示例</span></span>\n<span class=\"line\"><span>type LoginReq {</span></span>\n<span class=\"line\"><span>    Username string `json:\"username,example=username\"`</span></span>\n<span class=\"line\"><span>    Password string `json:\"password,example=123456\"`</span></span>\n<span class=\"line\"><span>}</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>// 如果需要字段可选，就需要加上 optional 标记</span></span>\n<span class=\"line\"><span>type LoginResp {</span></span>\n<span class=\"line\"><span>    Name string `json:\"name,optional\"`</span></span>\n<span class=\"line\"><span>}</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>type FormExampleReq {</span></span>\n<span class=\"line\"><span>    Name string `form:\"name\"`</span></span>\n<span class=\"line\"><span>}</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>type PathExampleReq {</span></span>\n<span class=\"line\"><span>    // path 标签修饰的 id 必须与请求路由中的片段对应，如</span></span>\n<span class=\"line\"><span>    // id 在 service 语法块的请求路径上一定会有 :id 对应，见下文。</span></span>\n<span class=\"line\"><span>    ID string `path:\"id\"`</span></span>\n<span class=\"line\"><span>}</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>type PathExampleResp {</span></span>\n<span class=\"line\"><span>    Name string `json:\"name\"`</span></span>\n<span class=\"line\"><span>}</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>// 这里定义的 @server 针对下面的 service ，如果有其他的，就在其他 service 上面定义 @server</span></span>\n<span class=\"line\"><span>@server (</span></span>\n<span class=\"line\"><span>    jwt:        Auth // 对当前 Foo 语法块下的所有路由，开启 jwt 认证，不需要则请删除此行</span></span>\n<span class=\"line\"><span>    prefix:     /v1 // 对当前 Foo 语法块下的所有路由，新增 /v1 路由前缀，不需要则请删除此行</span></span>\n<span class=\"line\"><span>    group:      g1 // 对当前 Foo 语法块下的所有路由，路由归并到 g1 目录下，不需要则请删除此行</span></span>\n<span class=\"line\"><span>    timeout:    3s // 对当前 Foo 语法块下的所有路由进行超时配置，不需要则请删除此行</span></span>\n<span class=\"line\"><span>    middleware: AuthInterceptor // 对当前 Foo 语法块下的所有路由添加中间件，不需要则请删除此行</span></span>\n<span class=\"line\"><span>    maxBytes:   1048576 // 对当前 Foo 语法块下的所有路由添加请求体大小控制，单位为 byte,goctl 版本 >= 1.5.0 才支持</span></span>\n<span class=\"line\"><span>)</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>// 这里是定义的接口</span></span>\n<span class=\"line\"><span>service Foo {</span></span>\n<span class=\"line\"><span>    // 定义没有请求体和响应体的接口，如 ping</span></span>\n<span class=\"line\"><span>    @handler ping</span></span>\n<span class=\"line\"><span>    get /ping</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    // 定义只有请求体的接口，如更新信息</span></span>\n<span class=\"line\"><span>    @handler update</span></span>\n<span class=\"line\"><span>    post /update (UpdateReq)</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    // 定义只有响应体的结构，如获取全部信息列表</span></span>\n<span class=\"line\"><span>    @handler list</span></span>\n<span class=\"line\"><span>    get /list returns ([]ListItem)</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    // 定义有结构体和响应体的接口，如登录</span></span>\n<span class=\"line\"><span>    @handler login</span></span>\n<span class=\"line\"><span>    post /login (LoginReq) returns (LoginResp)</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    // 定义表单请求</span></span>\n<span class=\"line\"><span>    @handler formExample</span></span>\n<span class=\"line\"><span>    post /form/example (FormExampleReq)</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    // 定义 path 参数</span></span>\n<span class=\"line\"><span>    @handler pathExample</span></span>\n<span class=\"line\"><span>    get /path/example/:id (PathExampleReq) returns (PathExampleResp)</span></span>\n<span class=\"line\"><span>}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div></div><h3 id=\"生成代码\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#生成代码\"><span>生成代码</span></a></h3>\n<ul>\n<li>创建对应的<code v-pre>api</code>文件</li>\n<li>使用 <code v-pre>goctl api go --api {{api文件路径}} --dir {{生成文件目录}}</code></li>\n</ul>\n<h2 id=\"响应模板定义\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#响应模板定义\"><span>响应模板定义</span></a></h2>\n<p>使用 <code v-pre>goctl</code> 创建代码时，一般会使用对应的模板文件，默认是用户目录的 <code v-pre>.goctl</code> 目录中，从对应版本的文件夹进去，如果没有使用 <code v-pre>goctl template init</code> 来生成模板</p>\n<p>在创建响应的时候，我们一般是使用固定的返回格式，比如：</p>\n<div class=\"code-block-title\" data-title=\"响应示例.json\"><div class=\"code-block-title-bar\"><span class=\"title\"><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-json\"/>响应示例.json</span></div><div class=\"language-json line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"json\" style=\"--shiki-light:#4c4f69;--shiki-dark:#c6d0f5;--shiki-light-bg:#eff1f5;--shiki-dark-bg:#303446\"><pre class=\"shiki shiki-themes catppuccin-latte catppuccin-frappe vp-code\" v-pre=\"\"><code class=\"language-json\"><span class=\"line\"><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">  \"</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">code</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">\"</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">:</span><span style=\"--shiki-light:#FE640B;--shiki-dark:#EF9F76\"> 0</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">  \"</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">data</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">\"</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">:</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\"> {},</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">  \"</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">msg</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">\"</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">:</span><span style=\"--shiki-light:#40A02B;--shiki-dark:#A6D189\"> \"成功\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div></div><p>如果我们直接使用 <code v-pre>api</code> 文件定义，需要每次都编写 <code v-pre>code</code> 和 <code v-pre>msg</code> 这个固定类型，我们可以使用官方扩展的 <code v-pre>x</code> 包，也可以自定义一下响应，这里使用官方的 <code v-pre>x</code> 包，你需要使用 <code v-pre>go get github.com/zeromicro/x</code> 安装</p>\n<p>接下来，我们还有问题，这个配置文件在我们自己的用户目录，如果别人拿到项目，没有这个文件就不行，生成出来会不一样，所以我们还需要放在项目中，更好使用</p>\n<p>以下是整个操作的具体步骤：</p>\n<ul>\n<li>使用 <code v-pre>goctl template init</code> 初始化模板文件，文件生成到 <code v-pre>~/.goctl/{version}</code> 下面</li>\n<li>在项目中创建一个 <code v-pre>templates</code> 文件夹，名字可自定义</li>\n<li>将生成的所有模板文件，放到项目的 <code v-pre>templates</code> 文件夹下</li>\n<li>修改 <code v-pre>handle.tpl</code> 文件，这是用于生成 <code v-pre>handle</code> 代码的模板</li>\n<li>修改内容如下：</li>\n</ul>\n<div class=\"code-block-title\" data-title=\"模板内容.go\"><div class=\"code-block-title-bar\"><span class=\"title\"><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\"/>模板内容.go</span></div><div class=\"language-go line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"go\" style=\"--shiki-light:#4c4f69;--shiki-dark:#c6d0f5;--shiki-light-bg:#eff1f5;--shiki-dark-bg:#303446\"><pre class=\"shiki shiki-themes catppuccin-latte catppuccin-frappe vp-code\" v-pre=\"\"><code class=\"language-go\"><span class=\"line\"><span style=\"--shiki-light:#8839EF;--shiki-dark:#CA9EE6\">package</span><span style=\"--shiki-light:#DF8E1D;--shiki-light-font-style:italic;--shiki-dark:#E5C890;--shiki-dark-font-style:italic\"> {{.PkgName}}</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#8839EF;--shiki-dark:#CA9EE6\">import</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\"> (</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#40A02B;--shiki-dark:#A6D189\">\t\"net/http\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">\txhttp </span><span style=\"--shiki-light:#40A02B;--shiki-dark:#A6D189\">\"github.com/zeromicro/x/http\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#40A02B;--shiki-dark:#A6D189\">\t\"github.com/zeromicro/go-zero/rest/httpx\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">\t{{.ImportPackages}}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">{{if .HasDoc}}{{.Doc}}{{end}}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#8839EF;--shiki-dark:#CA9EE6\">func</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\"> {{.HandlerName}}</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(</span><span style=\"--shiki-light:#E64553;--shiki-light-font-style:italic;--shiki-dark:#EA999C;--shiki-dark-font-style:italic\">svcCtx</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\"> *</span><span style=\"--shiki-light:#DF8E1D;--shiki-light-font-style:italic;--shiki-dark:#E5C890;--shiki-dark-font-style:italic\">svc</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#DF8E1D;--shiki-light-font-style:italic;--shiki-dark:#E5C890;--shiki-dark-font-style:italic\">ServiceContext</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">)</span><span style=\"--shiki-light:#DF8E1D;--shiki-light-font-style:italic;--shiki-dark:#E5C890;--shiki-dark-font-style:italic\"> http</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#DF8E1D;--shiki-light-font-style:italic;--shiki-dark:#E5C890;--shiki-dark-font-style:italic\">HandlerFunc</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#8839EF;--shiki-dark:#CA9EE6\">\treturn</span><span style=\"--shiki-light:#8839EF;--shiki-dark:#CA9EE6\"> func</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(</span><span style=\"--shiki-light:#E64553;--shiki-light-font-style:italic;--shiki-dark:#EA999C;--shiki-dark-font-style:italic\">w</span><span style=\"--shiki-light:#DF8E1D;--shiki-light-font-style:italic;--shiki-dark:#E5C890;--shiki-dark-font-style:italic\"> http</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#DF8E1D;--shiki-light-font-style:italic;--shiki-dark:#E5C890;--shiki-dark-font-style:italic\">ResponseWriter</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">,</span><span style=\"--shiki-light:#E64553;--shiki-light-font-style:italic;--shiki-dark:#EA999C;--shiki-dark-font-style:italic\"> r</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\"> *</span><span style=\"--shiki-light:#DF8E1D;--shiki-light-font-style:italic;--shiki-dark:#E5C890;--shiki-dark-font-style:italic\">http</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#DF8E1D;--shiki-light-font-style:italic;--shiki-dark:#E5C890;--shiki-dark-font-style:italic\">Request</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">)</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">\t\t{{if .HasRequest}}var req types</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">{{.RequestType}}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#8839EF;--shiki-dark:#CA9EE6\">\t\tif</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> err </span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">:=</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> httpx</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">Parse</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">r</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">,</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\"> &#x26;</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">req</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">);</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> err </span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">!=</span><span style=\"--shiki-light:#D20F39;--shiki-dark:#E78284\"> nil</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">\t\t\txhttp</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">JsonBaseResponseCtx</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">r</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">Context</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(),</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> w</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">,</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> err</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#8839EF;--shiki-dark:#CA9EE6\">\t\t\treturn</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">\t\t}</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">\t\t{{end}}l </span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">:=</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> {{.LogicName}}</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">New{{.LogicType}}</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">r</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">Context</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(),</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> svcCtx</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">\t\t{{if .HasResp}}resp</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">,</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> {{end}}err </span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">:=</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> l</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">{{.Call}}</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">{{if .HasRequest}}</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">&#x26;</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">req{{end}}</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#8839EF;--shiki-dark:#CA9EE6\">\t\tif</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> err </span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">!=</span><span style=\"--shiki-light:#D20F39;--shiki-dark:#E78284\"> nil</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">\t\t\txhttp</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">JsonBaseResponseCtx</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">r</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">Context</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(),</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> w</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">,</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> err</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">\t\t}</span><span style=\"--shiki-light:#8839EF;--shiki-dark:#CA9EE6\"> else</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">\t\t\t{{if .HasResp}}xhttp</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">JsonBaseResponseCtx</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">r</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">Context</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(),</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> w</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">,</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> resp</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">)</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">{{else}}httpx</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">Ok</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">w</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">)</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">{{end}}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">\t\t}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">\t}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div></div><ul>\n<li>使用 <code v-pre>api</code> 文件生成代码，使用 <code v-pre>--home</code> 参数指定使用项目 <code v-pre>templates</code> 文件夹下的模板：</li>\n</ul>\n<div class=\"language-powershell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"powershell\" style=\"--shiki-light:#4c4f69;--shiki-dark:#c6d0f5;--shiki-light-bg:#eff1f5;--shiki-dark-bg:#303446\"><pre class=\"shiki shiki-themes catppuccin-latte catppuccin-frappe vp-code\" v-pre=\"\"><code class=\"language-powershell\"><span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">goctl api go </span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">--</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">api {{api文件路径}} </span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">--</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">dir {{生成的文件夹路径}} </span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">--</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">home .\\templates</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><h2 id=\"swagger-文档\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#swagger-文档\"><span>Swagger 文档</span></a></h2>\n<p><code v-pre>api</code> 文件配置可参照官方：https://go-zero.dev/docs/tutorials/cli/swagger</p>\n<h3 id=\"集成到服务中\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#集成到服务中\"><span>集成到服务中</span></a></h3>\n<ul>\n<li>在项目中创建一个目录 <code v-pre>doc</code> 或者 <code v-pre>static</code> 都行</li>\n<li>使用 <code v-pre>goctl api swagger --api {{api文件路径}} --dir ./doc</code> 生成文件到指定的目录</li>\n<li>在新建的目录创建 <code v-pre>swagger.html</code> 文件，<code v-pre>json</code> 文件和 <code v-pre>html</code> 文件同一个目录，不同需要指定好路径，在 <code v-pre>html</code> 添加如下代码：</li>\n</ul>\n<div class=\"code-block-title\" data-title=\"swagger.html\"><div class=\"code-block-title-bar\"><span class=\"title\"><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-html\"/>swagger.html</span></div><div class=\"language-html line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"html\" style=\"--shiki-light:#4c4f69;--shiki-dark:#c6d0f5;--shiki-light-bg:#eff1f5;--shiki-dark-bg:#303446\"><pre class=\"shiki shiki-themes catppuccin-latte catppuccin-frappe vp-code\" v-pre=\"\"><code class=\"language-html\"><span class=\"line\"><span style=\"--shiki-light:#8839EF;--shiki-dark:#CA9EE6\">&#x3C;!DOCTYPE</span><span style=\"--shiki-light:#DF8E1D;--shiki-dark:#E5C890\"> html</span><span style=\"--shiki-light:#8839EF;--shiki-dark:#CA9EE6\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">&#x3C;</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">html</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">  &#x3C;</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">head</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">    &#x3C;</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">title</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">Swagger UI</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">&#x3C;/</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">title</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">    &#x3C;</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">link</span><span style=\"--shiki-light:#DF8E1D;--shiki-dark:#E5C890\"> rel</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">=</span><span style=\"--shiki-light:#40A02B;--shiki-dark:#A6D189\">\"stylesheet\"</span><span style=\"--shiki-light:#DF8E1D;--shiki-dark:#E5C890\"> href</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">=</span><span style=\"--shiki-light:#40A02B;--shiki-dark:#A6D189\">\"https://unpkg.com/swagger-ui-dist@5/swagger-ui.css\"</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\"> /></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">  &#x3C;/</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">head</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">  &#x3C;</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">body</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">    &#x3C;</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">div</span><span style=\"--shiki-light:#DF8E1D;--shiki-dark:#E5C890\"> id</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">=</span><span style=\"--shiki-light:#40A02B;--shiki-dark:#A6D189\">\"swagger-ui\"</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">>&#x3C;/</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">div</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">    &#x3C;</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">script</span><span style=\"--shiki-light:#DF8E1D;--shiki-dark:#E5C890\"> src</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">=</span><span style=\"--shiki-light:#40A02B;--shiki-dark:#A6D189\">\"https://unpkg.com/swagger-ui-dist@5/swagger-ui-bundle.js\"</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">&#x3C;</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">/</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">script</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">    &#x3C;</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">script</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">      SwaggerUIBundle</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">(</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">        url</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">:</span><span style=\"--shiki-light:#40A02B;--shiki-dark:#A6D189\"> \"./main.json\"</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">,</span><span style=\"--shiki-light:#7C7F93;--shiki-light-font-style:italic;--shiki-dark:#949CBB;--shiki-dark-font-style:italic\"> // 确保路径正确</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">        dom_id</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">:</span><span style=\"--shiki-light:#40A02B;--shiki-dark:#A6D189\"> '#swagger-ui'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">      }</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">)</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">    &#x3C;</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">/</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">script</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">  &#x3C;/</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">body</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">&#x3C;/</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">html</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div></div><ul>\n<li>进入主启动文件，获取当前的路径</li>\n</ul>\n<div class=\"code-block-title\" data-title=\"main.go\"><div class=\"code-block-title-bar\"><span class=\"title\"><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\"/>main.go</span></div><div class=\"language-go line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"go\" style=\"--shiki-light:#4c4f69;--shiki-dark:#c6d0f5;--shiki-light-bg:#eff1f5;--shiki-dark-bg:#303446\"><pre class=\"shiki shiki-themes catppuccin-latte catppuccin-frappe vp-code\" v-pre=\"\"><code class=\"language-go\"><span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">fs </span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">:=</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> http</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">Dir</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(</span><span style=\"--shiki-light:#40A02B;--shiki-dark:#A6D189\">\"./doc\"</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">)</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div></div><ul>\n<li>在定义 <code v-pre>server</code> 的代码中，加入静态文件服务</li>\n</ul>\n<div class=\"code-block-title\" data-title=\"main.go\"><div class=\"code-block-title-bar\"><span class=\"title\"><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\"/>main.go</span></div><div class=\"language-go line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"go\" style=\"--shiki-light:#4c4f69;--shiki-dark:#c6d0f5;--shiki-light-bg:#eff1f5;--shiki-dark-bg:#303446\"><pre class=\"shiki shiki-themes catppuccin-latte catppuccin-frappe vp-code\" v-pre=\"\"><code class=\"language-go\"><span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">server </span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">:=</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> rest</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">MustNewServer</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">c</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">RestConf</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">,</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> rest</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">WithFileServer</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(</span><span style=\"--shiki-light:#40A02B;--shiki-dark:#A6D189\">\"/static/\"</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">,</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> fs</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">))</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div></div><ul>\n<li>启动服务，查看地址：<code v-pre>http://127.0.0.1:8888/doc/swagger.html</code></li>\n</ul>\n","env":{"base":"/","filePath":"D:/vpress-docs/blog/docs/blog/golang/go-zero.md","filePathRelative":"blog/golang/go-zero.md","frontmatter":{"title":"go-zero 踩坑","createTime":"2025/10/12 11:53:07","permalink":"/blog/q37rgo16/","tags":["golang"]},"sfcBlocks":{"template":{"type":"template","content":"<template><h2 id=\"项目基础结构\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#项目基础结构\"><span>项目基础结构</span></a></h2>\n<div class=\"hint-container tip\">\n<p class=\"hint-container-title\">提示</p>\n<p>项目结构未使用微服务架构，以目前个人的项目来</p>\n</div>\n<div class=\"vp-file-tree\"><FileTreeNode expanded type=\"folder\" filename=\"api\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:folder-type-api\" /></template><template #comment>// 存放 api 文件</template><FileTreeNode type=\"file\" filename=\"user.api\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-file\" /></template>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"const\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><template #comment>// 一些常量</template><FileTreeNode expanded type=\"folder\" filename=\"ec\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><template #comment>// 存放错误枚举</template><FileTreeNode type=\"file\" filename=\"common.go\" :level=\"2\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n<FileTreeNode type=\"file\" filename=\"user.go\" :level=\"2\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"docs\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:folder-type-docs\" /></template><template #comment>// 文档内容</template><FileTreeNode type=\"file\" filename=\"main.json\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-json\" /></template><template #comment>// goctl 生成的swagger数据</template>\n</FileTreeNode>\n<FileTreeNode type=\"file\" filename=\"swagger.html\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-html\" /></template><template #comment>// 自定义随项目启动的文件</template>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"etc\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><template #comment>// 由 goctl 生成，为配置文件</template><FileTreeNode type=\"file\" filename=\"main.yaml\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-light-yaml\" /></template>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"http\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><template #comment>// 相关 http 后缀文件， 用于接口请求测试</template><FileTreeNode type=\"file\" filename=\"login.http\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-file\" /></template>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"internal\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><template #comment>// goctl 生成，包含各类逻辑等文件</template><FileTreeNode expanded type=\"folder\" filename=\"config\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:folder-type-config\" /></template><FileTreeNode type=\"file\" filename=\"config.go\" :level=\"2\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"handler\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><FileTreeNode expanded type=\"folder\" filename=\"user\" :level=\"2\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><FileTreeNode type=\"file\" filename=\"getuserinfohandler.go\" :level=\"3\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n<FileTreeNode type=\"file\" filename=\"userloginhandler.go\" :level=\"3\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode type=\"file\" filename=\"routes.go\" :level=\"2\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"logic\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><FileTreeNode expanded type=\"folder\" filename=\"user\" :level=\"2\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><FileTreeNode type=\"file\" filename=\"getuserinfologic.go\" :level=\"3\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n<FileTreeNode type=\"file\" filename=\"userloginlogic.go\" :level=\"3\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"svc\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><FileTreeNode type=\"file\" filename=\"servicecontext.go\" :level=\"2\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"types\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:folder-type-typings\" /></template><FileTreeNode type=\"file\" filename=\"types.go\" :level=\"2\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"model\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:folder-type-model\" /></template><template #comment>//数据库文件</template><FileTreeNode type=\"file\" filename=\"user.go\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"templates\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:folder-type-template\" /></template><template #comment>// 存放自定义的 goctl 模板文件</template><FileTreeNode expanded type=\"folder\" filename=\"api\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:folder-type-api\" /></template><FileTreeNode type=\"file\" filename=\"...\" :level=\"2\">\n\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"docker\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><FileTreeNode type=\"file\" filename=\"...\" :level=\"2\">\n\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"geteway\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><FileTreeNode type=\"file\" filename=\"...\" :level=\"2\">\n\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"kube\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><FileTreeNode type=\"file\" filename=\"...\" :level=\"2\">\n\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"model\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:folder-type-model\" /></template><FileTreeNode type=\"file\" filename=\"...\" :level=\"2\">\n\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"mongo\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><FileTreeNode type=\"file\" filename=\"...\" :level=\"2\">\n\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"newapi\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><FileTreeNode type=\"file\" filename=\"...\" :level=\"2\">\n\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"rpc\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><FileTreeNode type=\"file\" filename=\"...\" :level=\"2\">\n\n</FileTreeNode>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"utils\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:folder-type-tools\" /></template><template #comment>// 自定义功能</template><FileTreeNode type=\"file\" filename=\"init_db.go\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n<FileTreeNode type=\"file\" filename=\"jwt.go\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode type=\"file\" filename=\"Dockerfile\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-docker\" /></template>\n</FileTreeNode>\n<FileTreeNode type=\"file\" filename=\"README.md\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"flat-color-icons:info\" /></template>\n</FileTreeNode>\n<FileTreeNode type=\"file\" filename=\"go.mod\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-file\" /></template>\n</FileTreeNode>\n<FileTreeNode type=\"file\" filename=\"go.sum\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-file\" /></template>\n</FileTreeNode>\n<FileTreeNode type=\"file\" filename=\"main.go\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode></div>\n<h2 id=\"生成api代码\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#生成api代码\"><span>生成api代码</span></a></h2>\n<h3 id=\"api-文件基本使用\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#api-文件基本使用\"><span>api 文件基本使用</span></a></h3>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>使用 <code v-pre>goctl api go </code> 来生成代码，会跳过已经生成的文件，所以如果新增接口、类型，需要删除无需手动编辑的文件，如 <code v-pre>types</code> 目录、主文件（路由注册）等，这个代表生成的类型等，即需要重新生成的删除，不需要的保留</p>\n<p>比如一个 <code v-pre>user</code> 服务，你修改了某个接口的类型和接口定义，你需要删除 <code v-pre>handler</code> 、<code v-pre>types</code> ，然后重新执行 <code v-pre>goctl api go</code> 的命令，<code v-pre>logic</code> 逻辑代码已经改过，不要删除，精准情况下，只删除对应的文件也行</p>\n</div>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p><code v-pre>api</code> 文件中，只能有对应名称的 <code v-pre>service</code> ，创建多个 <code v-pre>service</code> 必须是同名的，即使使用 <code v-pre>import</code> 导入其他 <code v-pre>api</code> 文件也不行</p>\n</div>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>在 <code v-pre>api</code> 文件中，可以在 <code v-pre>@server</code> 中指定 <code v-pre>group</code> 参数，生成的 <code v-pre>logic</code> 和 <code v-pre>handler</code> 可以使用不同的文件夹存在，可以进行不同分类</p>\n</div>\n<p>在你的项目目标文件夹中，创建一个 <code v-pre>api</code> 文件，也可以使用 <code v-pre>goctl api template -o {{目标文件夹}}\\{{文件名}}.api</code> 来生成一个 <code v-pre>api</code> 文件</p>\n<p>官方示例：</p>\n<div class=\"code-block-title\" data-title=\"api文件\"><div class=\"code-block-title-bar\"><span class=\"title\">api文件</span></div><div class=\"language-text line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"text\" style=\"--shiki-light:#4c4f69;--shiki-dark:#c6d0f5;--shiki-light-bg:#eff1f5;--shiki-dark-bg:#303446\"><pre class=\"shiki shiki-themes catppuccin-latte catppuccin-frappe vp-code\" v-pre=\"\"><code class=\"language-text\"><span class=\"line\"><span>syntax = \"v1\"</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>// 这里的主要用在 swagger 文件显示</span></span>\n<span class=\"line\"><span>info (</span></span>\n<span class=\"line\"><span>    title:   \"api 文件完整示例写法\"</span></span>\n<span class=\"line\"><span>    desc:    \"演示如何编写 api 文件\"</span></span>\n<span class=\"line\"><span>    author:  \"keson.an\"</span></span>\n<span class=\"line\"><span>    date:    \"2022 年 12 月 26 日\"</span></span>\n<span class=\"line\"><span>    version: \"v1\"</span></span>\n<span class=\"line\"><span>)</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>// 使用 type 定义请求结构体</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>type UpdateReq {</span></span>\n<span class=\"line\"><span>    Arg1 string `json:\"arg1\"`</span></span>\n<span class=\"line\"><span>}</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>type ListItem {</span></span>\n<span class=\"line\"><span>    Value1 string `json:\"value1\"`</span></span>\n<span class=\"line\"><span>}</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>// 可以使用 example 在生成 swagger 时给出一些数据的示例</span></span>\n<span class=\"line\"><span>type LoginReq {</span></span>\n<span class=\"line\"><span>    Username string `json:\"username,example=username\"`</span></span>\n<span class=\"line\"><span>    Password string `json:\"password,example=123456\"`</span></span>\n<span class=\"line\"><span>}</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>// 如果需要字段可选，就需要加上 optional 标记</span></span>\n<span class=\"line\"><span>type LoginResp {</span></span>\n<span class=\"line\"><span>    Name string `json:\"name,optional\"`</span></span>\n<span class=\"line\"><span>}</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>type FormExampleReq {</span></span>\n<span class=\"line\"><span>    Name string `form:\"name\"`</span></span>\n<span class=\"line\"><span>}</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>type PathExampleReq {</span></span>\n<span class=\"line\"><span>    // path 标签修饰的 id 必须与请求路由中的片段对应，如</span></span>\n<span class=\"line\"><span>    // id 在 service 语法块的请求路径上一定会有 :id 对应，见下文。</span></span>\n<span class=\"line\"><span>    ID string `path:\"id\"`</span></span>\n<span class=\"line\"><span>}</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>type PathExampleResp {</span></span>\n<span class=\"line\"><span>    Name string `json:\"name\"`</span></span>\n<span class=\"line\"><span>}</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>// 这里定义的 @server 针对下面的 service ，如果有其他的，就在其他 service 上面定义 @server</span></span>\n<span class=\"line\"><span>@server (</span></span>\n<span class=\"line\"><span>    jwt:        Auth // 对当前 Foo 语法块下的所有路由，开启 jwt 认证，不需要则请删除此行</span></span>\n<span class=\"line\"><span>    prefix:     /v1 // 对当前 Foo 语法块下的所有路由，新增 /v1 路由前缀，不需要则请删除此行</span></span>\n<span class=\"line\"><span>    group:      g1 // 对当前 Foo 语法块下的所有路由，路由归并到 g1 目录下，不需要则请删除此行</span></span>\n<span class=\"line\"><span>    timeout:    3s // 对当前 Foo 语法块下的所有路由进行超时配置，不需要则请删除此行</span></span>\n<span class=\"line\"><span>    middleware: AuthInterceptor // 对当前 Foo 语法块下的所有路由添加中间件，不需要则请删除此行</span></span>\n<span class=\"line\"><span>    maxBytes:   1048576 // 对当前 Foo 语法块下的所有路由添加请求体大小控制，单位为 byte,goctl 版本 >= 1.5.0 才支持</span></span>\n<span class=\"line\"><span>)</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>// 这里是定义的接口</span></span>\n<span class=\"line\"><span>service Foo {</span></span>\n<span class=\"line\"><span>    // 定义没有请求体和响应体的接口，如 ping</span></span>\n<span class=\"line\"><span>    @handler ping</span></span>\n<span class=\"line\"><span>    get /ping</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    // 定义只有请求体的接口，如更新信息</span></span>\n<span class=\"line\"><span>    @handler update</span></span>\n<span class=\"line\"><span>    post /update (UpdateReq)</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    // 定义只有响应体的结构，如获取全部信息列表</span></span>\n<span class=\"line\"><span>    @handler list</span></span>\n<span class=\"line\"><span>    get /list returns ([]ListItem)</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    // 定义有结构体和响应体的接口，如登录</span></span>\n<span class=\"line\"><span>    @handler login</span></span>\n<span class=\"line\"><span>    post /login (LoginReq) returns (LoginResp)</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    // 定义表单请求</span></span>\n<span class=\"line\"><span>    @handler formExample</span></span>\n<span class=\"line\"><span>    post /form/example (FormExampleReq)</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    // 定义 path 参数</span></span>\n<span class=\"line\"><span>    @handler pathExample</span></span>\n<span class=\"line\"><span>    get /path/example/:id (PathExampleReq) returns (PathExampleResp)</span></span>\n<span class=\"line\"><span>}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div></div><h3 id=\"生成代码\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#生成代码\"><span>生成代码</span></a></h3>\n<ul>\n<li>创建对应的<code v-pre>api</code>文件</li>\n<li>使用 <code v-pre>goctl api go --api {{api文件路径}} --dir {{生成文件目录}}</code></li>\n</ul>\n<h2 id=\"响应模板定义\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#响应模板定义\"><span>响应模板定义</span></a></h2>\n<p>使用 <code v-pre>goctl</code> 创建代码时，一般会使用对应的模板文件，默认是用户目录的 <code v-pre>.goctl</code> 目录中，从对应版本的文件夹进去，如果没有使用 <code v-pre>goctl template init</code> 来生成模板</p>\n<p>在创建响应的时候，我们一般是使用固定的返回格式，比如：</p>\n<div class=\"code-block-title\" data-title=\"响应示例.json\"><div class=\"code-block-title-bar\"><span class=\"title\"><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-json\"/>响应示例.json</span></div><div class=\"language-json line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"json\" style=\"--shiki-light:#4c4f69;--shiki-dark:#c6d0f5;--shiki-light-bg:#eff1f5;--shiki-dark-bg:#303446\"><pre class=\"shiki shiki-themes catppuccin-latte catppuccin-frappe vp-code\" v-pre=\"\"><code class=\"language-json\"><span class=\"line\"><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">  \"</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">code</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">\"</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">:</span><span style=\"--shiki-light:#FE640B;--shiki-dark:#EF9F76\"> 0</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">  \"</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">data</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">\"</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">:</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\"> {},</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">  \"</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">msg</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">\"</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">:</span><span style=\"--shiki-light:#40A02B;--shiki-dark:#A6D189\"> \"成功\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div></div><p>如果我们直接使用 <code v-pre>api</code> 文件定义，需要每次都编写 <code v-pre>code</code> 和 <code v-pre>msg</code> 这个固定类型，我们可以使用官方扩展的 <code v-pre>x</code> 包，也可以自定义一下响应，这里使用官方的 <code v-pre>x</code> 包，你需要使用 <code v-pre>go get github.com/zeromicro/x</code> 安装</p>\n<p>接下来，我们还有问题，这个配置文件在我们自己的用户目录，如果别人拿到项目，没有这个文件就不行，生成出来会不一样，所以我们还需要放在项目中，更好使用</p>\n<p>以下是整个操作的具体步骤：</p>\n<ul>\n<li>使用 <code v-pre>goctl template init</code> 初始化模板文件，文件生成到 <code v-pre>~/.goctl/{version}</code> 下面</li>\n<li>在项目中创建一个 <code v-pre>templates</code> 文件夹，名字可自定义</li>\n<li>将生成的所有模板文件，放到项目的 <code v-pre>templates</code> 文件夹下</li>\n<li>修改 <code v-pre>handle.tpl</code> 文件，这是用于生成 <code v-pre>handle</code> 代码的模板</li>\n<li>修改内容如下：</li>\n</ul>\n<div class=\"code-block-title\" data-title=\"模板内容.go\"><div class=\"code-block-title-bar\"><span class=\"title\"><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\"/>模板内容.go</span></div><div class=\"language-go line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"go\" style=\"--shiki-light:#4c4f69;--shiki-dark:#c6d0f5;--shiki-light-bg:#eff1f5;--shiki-dark-bg:#303446\"><pre class=\"shiki shiki-themes catppuccin-latte catppuccin-frappe vp-code\" v-pre=\"\"><code class=\"language-go\"><span class=\"line\"><span style=\"--shiki-light:#8839EF;--shiki-dark:#CA9EE6\">package</span><span style=\"--shiki-light:#DF8E1D;--shiki-light-font-style:italic;--shiki-dark:#E5C890;--shiki-dark-font-style:italic\"> {{.PkgName}}</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#8839EF;--shiki-dark:#CA9EE6\">import</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\"> (</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#40A02B;--shiki-dark:#A6D189\">\t\"net/http\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">\txhttp </span><span style=\"--shiki-light:#40A02B;--shiki-dark:#A6D189\">\"github.com/zeromicro/x/http\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#40A02B;--shiki-dark:#A6D189\">\t\"github.com/zeromicro/go-zero/rest/httpx\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">\t{{.ImportPackages}}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">{{if .HasDoc}}{{.Doc}}{{end}}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#8839EF;--shiki-dark:#CA9EE6\">func</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\"> {{.HandlerName}}</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(</span><span style=\"--shiki-light:#E64553;--shiki-light-font-style:italic;--shiki-dark:#EA999C;--shiki-dark-font-style:italic\">svcCtx</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\"> *</span><span style=\"--shiki-light:#DF8E1D;--shiki-light-font-style:italic;--shiki-dark:#E5C890;--shiki-dark-font-style:italic\">svc</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#DF8E1D;--shiki-light-font-style:italic;--shiki-dark:#E5C890;--shiki-dark-font-style:italic\">ServiceContext</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">)</span><span style=\"--shiki-light:#DF8E1D;--shiki-light-font-style:italic;--shiki-dark:#E5C890;--shiki-dark-font-style:italic\"> http</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#DF8E1D;--shiki-light-font-style:italic;--shiki-dark:#E5C890;--shiki-dark-font-style:italic\">HandlerFunc</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#8839EF;--shiki-dark:#CA9EE6\">\treturn</span><span style=\"--shiki-light:#8839EF;--shiki-dark:#CA9EE6\"> func</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(</span><span style=\"--shiki-light:#E64553;--shiki-light-font-style:italic;--shiki-dark:#EA999C;--shiki-dark-font-style:italic\">w</span><span style=\"--shiki-light:#DF8E1D;--shiki-light-font-style:italic;--shiki-dark:#E5C890;--shiki-dark-font-style:italic\"> http</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#DF8E1D;--shiki-light-font-style:italic;--shiki-dark:#E5C890;--shiki-dark-font-style:italic\">ResponseWriter</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">,</span><span style=\"--shiki-light:#E64553;--shiki-light-font-style:italic;--shiki-dark:#EA999C;--shiki-dark-font-style:italic\"> r</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\"> *</span><span style=\"--shiki-light:#DF8E1D;--shiki-light-font-style:italic;--shiki-dark:#E5C890;--shiki-dark-font-style:italic\">http</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#DF8E1D;--shiki-light-font-style:italic;--shiki-dark:#E5C890;--shiki-dark-font-style:italic\">Request</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">)</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">\t\t{{if .HasRequest}}var req types</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">{{.RequestType}}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#8839EF;--shiki-dark:#CA9EE6\">\t\tif</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> err </span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">:=</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> httpx</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">Parse</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">r</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">,</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\"> &#x26;</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">req</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">);</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> err </span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">!=</span><span style=\"--shiki-light:#D20F39;--shiki-dark:#E78284\"> nil</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">\t\t\txhttp</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">JsonBaseResponseCtx</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">r</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">Context</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(),</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> w</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">,</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> err</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#8839EF;--shiki-dark:#CA9EE6\">\t\t\treturn</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">\t\t}</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">\t\t{{end}}l </span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">:=</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> {{.LogicName}}</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">New{{.LogicType}}</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">r</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">Context</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(),</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> svcCtx</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">\t\t{{if .HasResp}}resp</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">,</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> {{end}}err </span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">:=</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> l</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">{{.Call}}</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">{{if .HasRequest}}</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">&#x26;</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">req{{end}}</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#8839EF;--shiki-dark:#CA9EE6\">\t\tif</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> err </span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">!=</span><span style=\"--shiki-light:#D20F39;--shiki-dark:#E78284\"> nil</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">\t\t\txhttp</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">JsonBaseResponseCtx</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">r</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">Context</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(),</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> w</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">,</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> err</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">\t\t}</span><span style=\"--shiki-light:#8839EF;--shiki-dark:#CA9EE6\"> else</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">\t\t\t{{if .HasResp}}xhttp</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">JsonBaseResponseCtx</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">r</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">Context</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(),</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> w</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">,</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> resp</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">)</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">{{else}}httpx</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">Ok</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">w</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">)</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">{{end}}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">\t\t}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">\t}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div></div><ul>\n<li>使用 <code v-pre>api</code> 文件生成代码，使用 <code v-pre>--home</code> 参数指定使用项目 <code v-pre>templates</code> 文件夹下的模板：</li>\n</ul>\n<div class=\"language-powershell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"powershell\" style=\"--shiki-light:#4c4f69;--shiki-dark:#c6d0f5;--shiki-light-bg:#eff1f5;--shiki-dark-bg:#303446\"><pre class=\"shiki shiki-themes catppuccin-latte catppuccin-frappe vp-code\" v-pre=\"\"><code class=\"language-powershell\"><span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">goctl api go </span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">--</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">api {{api文件路径}} </span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">--</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">dir {{生成的文件夹路径}} </span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">--</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">home .\\templates</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><h2 id=\"swagger-文档\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#swagger-文档\"><span>Swagger 文档</span></a></h2>\n<p><code v-pre>api</code> 文件配置可参照官方：https://go-zero.dev/docs/tutorials/cli/swagger</p>\n<h3 id=\"集成到服务中\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#集成到服务中\"><span>集成到服务中</span></a></h3>\n<ul>\n<li>在项目中创建一个目录 <code v-pre>doc</code> 或者 <code v-pre>static</code> 都行</li>\n<li>使用 <code v-pre>goctl api swagger --api {{api文件路径}} --dir ./doc</code> 生成文件到指定的目录</li>\n<li>在新建的目录创建 <code v-pre>swagger.html</code> 文件，<code v-pre>json</code> 文件和 <code v-pre>html</code> 文件同一个目录，不同需要指定好路径，在 <code v-pre>html</code> 添加如下代码：</li>\n</ul>\n<div class=\"code-block-title\" data-title=\"swagger.html\"><div class=\"code-block-title-bar\"><span class=\"title\"><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-html\"/>swagger.html</span></div><div class=\"language-html line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"html\" style=\"--shiki-light:#4c4f69;--shiki-dark:#c6d0f5;--shiki-light-bg:#eff1f5;--shiki-dark-bg:#303446\"><pre class=\"shiki shiki-themes catppuccin-latte catppuccin-frappe vp-code\" v-pre=\"\"><code class=\"language-html\"><span class=\"line\"><span style=\"--shiki-light:#8839EF;--shiki-dark:#CA9EE6\">&#x3C;!DOCTYPE</span><span style=\"--shiki-light:#DF8E1D;--shiki-dark:#E5C890\"> html</span><span style=\"--shiki-light:#8839EF;--shiki-dark:#CA9EE6\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">&#x3C;</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">html</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">  &#x3C;</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">head</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">    &#x3C;</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">title</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">Swagger UI</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">&#x3C;/</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">title</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">    &#x3C;</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">link</span><span style=\"--shiki-light:#DF8E1D;--shiki-dark:#E5C890\"> rel</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">=</span><span style=\"--shiki-light:#40A02B;--shiki-dark:#A6D189\">\"stylesheet\"</span><span style=\"--shiki-light:#DF8E1D;--shiki-dark:#E5C890\"> href</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">=</span><span style=\"--shiki-light:#40A02B;--shiki-dark:#A6D189\">\"https://unpkg.com/swagger-ui-dist@5/swagger-ui.css\"</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\"> /></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">  &#x3C;/</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">head</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">  &#x3C;</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">body</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">    &#x3C;</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">div</span><span style=\"--shiki-light:#DF8E1D;--shiki-dark:#E5C890\"> id</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">=</span><span style=\"--shiki-light:#40A02B;--shiki-dark:#A6D189\">\"swagger-ui\"</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">>&#x3C;/</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">div</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">    &#x3C;</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">script</span><span style=\"--shiki-light:#DF8E1D;--shiki-dark:#E5C890\"> src</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">=</span><span style=\"--shiki-light:#40A02B;--shiki-dark:#A6D189\">\"https://unpkg.com/swagger-ui-dist@5/swagger-ui-bundle.js\"</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">&#x3C;</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">/</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">script</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">    &#x3C;</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">script</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">      SwaggerUIBundle</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">(</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">        url</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">:</span><span style=\"--shiki-light:#40A02B;--shiki-dark:#A6D189\"> \"./main.json\"</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">,</span><span style=\"--shiki-light:#7C7F93;--shiki-light-font-style:italic;--shiki-dark:#949CBB;--shiki-dark-font-style:italic\"> // 确保路径正确</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">        dom_id</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">:</span><span style=\"--shiki-light:#40A02B;--shiki-dark:#A6D189\"> '#swagger-ui'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">      }</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">)</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">    &#x3C;</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">/</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">script</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">  &#x3C;/</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">body</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">&#x3C;/</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">html</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div></div><ul>\n<li>进入主启动文件，获取当前的路径</li>\n</ul>\n<div class=\"code-block-title\" data-title=\"main.go\"><div class=\"code-block-title-bar\"><span class=\"title\"><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\"/>main.go</span></div><div class=\"language-go line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"go\" style=\"--shiki-light:#4c4f69;--shiki-dark:#c6d0f5;--shiki-light-bg:#eff1f5;--shiki-dark-bg:#303446\"><pre class=\"shiki shiki-themes catppuccin-latte catppuccin-frappe vp-code\" v-pre=\"\"><code class=\"language-go\"><span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">fs </span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">:=</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> http</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">Dir</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(</span><span style=\"--shiki-light:#40A02B;--shiki-dark:#A6D189\">\"./doc\"</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">)</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div></div><ul>\n<li>在定义 <code v-pre>server</code> 的代码中，加入静态文件服务</li>\n</ul>\n<div class=\"code-block-title\" data-title=\"main.go\"><div class=\"code-block-title-bar\"><span class=\"title\"><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\"/>main.go</span></div><div class=\"language-go line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"go\" style=\"--shiki-light:#4c4f69;--shiki-dark:#c6d0f5;--shiki-light-bg:#eff1f5;--shiki-dark-bg:#303446\"><pre class=\"shiki shiki-themes catppuccin-latte catppuccin-frappe vp-code\" v-pre=\"\"><code class=\"language-go\"><span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">server </span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">:=</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> rest</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">MustNewServer</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">c</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">RestConf</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">,</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> rest</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">WithFileServer</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(</span><span style=\"--shiki-light:#40A02B;--shiki-dark:#A6D189\">\"/static/\"</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">,</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> fs</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">))</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div></div><ul>\n<li>启动服务，查看地址：<code v-pre>http://127.0.0.1:8888/doc/swagger.html</code></li>\n</ul>\n</template>","contentStripped":"<h2 id=\"项目基础结构\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#项目基础结构\"><span>项目基础结构</span></a></h2>\n<div class=\"hint-container tip\">\n<p class=\"hint-container-title\">提示</p>\n<p>项目结构未使用微服务架构，以目前个人的项目来</p>\n</div>\n<div class=\"vp-file-tree\"><FileTreeNode expanded type=\"folder\" filename=\"api\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:folder-type-api\" /></template><template #comment>// 存放 api 文件</template><FileTreeNode type=\"file\" filename=\"user.api\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-file\" /></template>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"const\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><template #comment>// 一些常量</template><FileTreeNode expanded type=\"folder\" filename=\"ec\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><template #comment>// 存放错误枚举</template><FileTreeNode type=\"file\" filename=\"common.go\" :level=\"2\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n<FileTreeNode type=\"file\" filename=\"user.go\" :level=\"2\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"docs\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:folder-type-docs\" /></template><template #comment>// 文档内容</template><FileTreeNode type=\"file\" filename=\"main.json\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-json\" /></template><template #comment>// goctl 生成的swagger数据</template>\n</FileTreeNode>\n<FileTreeNode type=\"file\" filename=\"swagger.html\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-html\" /></template><template #comment>// 自定义随项目启动的文件</template>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"etc\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><template #comment>// 由 goctl 生成，为配置文件</template><FileTreeNode type=\"file\" filename=\"main.yaml\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-light-yaml\" /></template>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"http\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><template #comment>// 相关 http 后缀文件， 用于接口请求测试</template><FileTreeNode type=\"file\" filename=\"login.http\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-file\" /></template>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"internal\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><template #comment>// goctl 生成，包含各类逻辑等文件</template><FileTreeNode expanded type=\"folder\" filename=\"config\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:folder-type-config\" /></template><FileTreeNode type=\"file\" filename=\"config.go\" :level=\"2\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"handler\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><FileTreeNode expanded type=\"folder\" filename=\"user\" :level=\"2\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><FileTreeNode type=\"file\" filename=\"getuserinfohandler.go\" :level=\"3\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n<FileTreeNode type=\"file\" filename=\"userloginhandler.go\" :level=\"3\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode type=\"file\" filename=\"routes.go\" :level=\"2\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"logic\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><FileTreeNode expanded type=\"folder\" filename=\"user\" :level=\"2\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><FileTreeNode type=\"file\" filename=\"getuserinfologic.go\" :level=\"3\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n<FileTreeNode type=\"file\" filename=\"userloginlogic.go\" :level=\"3\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"svc\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><FileTreeNode type=\"file\" filename=\"servicecontext.go\" :level=\"2\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"types\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:folder-type-typings\" /></template><FileTreeNode type=\"file\" filename=\"types.go\" :level=\"2\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"model\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:folder-type-model\" /></template><template #comment>//数据库文件</template><FileTreeNode type=\"file\" filename=\"user.go\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"templates\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:folder-type-template\" /></template><template #comment>// 存放自定义的 goctl 模板文件</template><FileTreeNode expanded type=\"folder\" filename=\"api\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:folder-type-api\" /></template><FileTreeNode type=\"file\" filename=\"...\" :level=\"2\">\n\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"docker\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><FileTreeNode type=\"file\" filename=\"...\" :level=\"2\">\n\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"geteway\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><FileTreeNode type=\"file\" filename=\"...\" :level=\"2\">\n\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"kube\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><FileTreeNode type=\"file\" filename=\"...\" :level=\"2\">\n\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"model\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:folder-type-model\" /></template><FileTreeNode type=\"file\" filename=\"...\" :level=\"2\">\n\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"mongo\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><FileTreeNode type=\"file\" filename=\"...\" :level=\"2\">\n\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"newapi\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><FileTreeNode type=\"file\" filename=\"...\" :level=\"2\">\n\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"rpc\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-folder\" /></template><FileTreeNode type=\"file\" filename=\"...\" :level=\"2\">\n\n</FileTreeNode>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode expanded type=\"folder\" filename=\"utils\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:folder-type-tools\" /></template><template #comment>// 自定义功能</template><FileTreeNode type=\"file\" filename=\"init_db.go\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n<FileTreeNode type=\"file\" filename=\"jwt.go\" :level=\"1\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode>\n</FileTreeNode>\n<FileTreeNode type=\"file\" filename=\"Dockerfile\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-docker\" /></template>\n</FileTreeNode>\n<FileTreeNode type=\"file\" filename=\"README.md\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"flat-color-icons:info\" /></template>\n</FileTreeNode>\n<FileTreeNode type=\"file\" filename=\"go.mod\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-file\" /></template>\n</FileTreeNode>\n<FileTreeNode type=\"file\" filename=\"go.sum\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:default-file\" /></template>\n</FileTreeNode>\n<FileTreeNode type=\"file\" filename=\"main.go\" :level=\"0\">\n<template #icon><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\" /></template>\n</FileTreeNode></div>\n<h2 id=\"生成api代码\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#生成api代码\"><span>生成api代码</span></a></h2>\n<h3 id=\"api-文件基本使用\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#api-文件基本使用\"><span>api 文件基本使用</span></a></h3>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>使用 <code v-pre>goctl api go </code> 来生成代码，会跳过已经生成的文件，所以如果新增接口、类型，需要删除无需手动编辑的文件，如 <code v-pre>types</code> 目录、主文件（路由注册）等，这个代表生成的类型等，即需要重新生成的删除，不需要的保留</p>\n<p>比如一个 <code v-pre>user</code> 服务，你修改了某个接口的类型和接口定义，你需要删除 <code v-pre>handler</code> 、<code v-pre>types</code> ，然后重新执行 <code v-pre>goctl api go</code> 的命令，<code v-pre>logic</code> 逻辑代码已经改过，不要删除，精准情况下，只删除对应的文件也行</p>\n</div>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p><code v-pre>api</code> 文件中，只能有对应名称的 <code v-pre>service</code> ，创建多个 <code v-pre>service</code> 必须是同名的，即使使用 <code v-pre>import</code> 导入其他 <code v-pre>api</code> 文件也不行</p>\n</div>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>在 <code v-pre>api</code> 文件中，可以在 <code v-pre>@server</code> 中指定 <code v-pre>group</code> 参数，生成的 <code v-pre>logic</code> 和 <code v-pre>handler</code> 可以使用不同的文件夹存在，可以进行不同分类</p>\n</div>\n<p>在你的项目目标文件夹中，创建一个 <code v-pre>api</code> 文件，也可以使用 <code v-pre>goctl api template -o {{目标文件夹}}\\{{文件名}}.api</code> 来生成一个 <code v-pre>api</code> 文件</p>\n<p>官方示例：</p>\n<div class=\"code-block-title\" data-title=\"api文件\"><div class=\"code-block-title-bar\"><span class=\"title\">api文件</span></div><div class=\"language-text line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"text\" style=\"--shiki-light:#4c4f69;--shiki-dark:#c6d0f5;--shiki-light-bg:#eff1f5;--shiki-dark-bg:#303446\"><pre class=\"shiki shiki-themes catppuccin-latte catppuccin-frappe vp-code\" v-pre=\"\"><code class=\"language-text\"><span class=\"line\"><span>syntax = \"v1\"</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>// 这里的主要用在 swagger 文件显示</span></span>\n<span class=\"line\"><span>info (</span></span>\n<span class=\"line\"><span>    title:   \"api 文件完整示例写法\"</span></span>\n<span class=\"line\"><span>    desc:    \"演示如何编写 api 文件\"</span></span>\n<span class=\"line\"><span>    author:  \"keson.an\"</span></span>\n<span class=\"line\"><span>    date:    \"2022 年 12 月 26 日\"</span></span>\n<span class=\"line\"><span>    version: \"v1\"</span></span>\n<span class=\"line\"><span>)</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>// 使用 type 定义请求结构体</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>type UpdateReq {</span></span>\n<span class=\"line\"><span>    Arg1 string `json:\"arg1\"`</span></span>\n<span class=\"line\"><span>}</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>type ListItem {</span></span>\n<span class=\"line\"><span>    Value1 string `json:\"value1\"`</span></span>\n<span class=\"line\"><span>}</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>// 可以使用 example 在生成 swagger 时给出一些数据的示例</span></span>\n<span class=\"line\"><span>type LoginReq {</span></span>\n<span class=\"line\"><span>    Username string `json:\"username,example=username\"`</span></span>\n<span class=\"line\"><span>    Password string `json:\"password,example=123456\"`</span></span>\n<span class=\"line\"><span>}</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>// 如果需要字段可选，就需要加上 optional 标记</span></span>\n<span class=\"line\"><span>type LoginResp {</span></span>\n<span class=\"line\"><span>    Name string `json:\"name,optional\"`</span></span>\n<span class=\"line\"><span>}</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>type FormExampleReq {</span></span>\n<span class=\"line\"><span>    Name string `form:\"name\"`</span></span>\n<span class=\"line\"><span>}</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>type PathExampleReq {</span></span>\n<span class=\"line\"><span>    // path 标签修饰的 id 必须与请求路由中的片段对应，如</span></span>\n<span class=\"line\"><span>    // id 在 service 语法块的请求路径上一定会有 :id 对应，见下文。</span></span>\n<span class=\"line\"><span>    ID string `path:\"id\"`</span></span>\n<span class=\"line\"><span>}</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>type PathExampleResp {</span></span>\n<span class=\"line\"><span>    Name string `json:\"name\"`</span></span>\n<span class=\"line\"><span>}</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>// 这里定义的 @server 针对下面的 service ，如果有其他的，就在其他 service 上面定义 @server</span></span>\n<span class=\"line\"><span>@server (</span></span>\n<span class=\"line\"><span>    jwt:        Auth // 对当前 Foo 语法块下的所有路由，开启 jwt 认证，不需要则请删除此行</span></span>\n<span class=\"line\"><span>    prefix:     /v1 // 对当前 Foo 语法块下的所有路由，新增 /v1 路由前缀，不需要则请删除此行</span></span>\n<span class=\"line\"><span>    group:      g1 // 对当前 Foo 语法块下的所有路由，路由归并到 g1 目录下，不需要则请删除此行</span></span>\n<span class=\"line\"><span>    timeout:    3s // 对当前 Foo 语法块下的所有路由进行超时配置，不需要则请删除此行</span></span>\n<span class=\"line\"><span>    middleware: AuthInterceptor // 对当前 Foo 语法块下的所有路由添加中间件，不需要则请删除此行</span></span>\n<span class=\"line\"><span>    maxBytes:   1048576 // 对当前 Foo 语法块下的所有路由添加请求体大小控制，单位为 byte,goctl 版本 >= 1.5.0 才支持</span></span>\n<span class=\"line\"><span>)</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>// 这里是定义的接口</span></span>\n<span class=\"line\"><span>service Foo {</span></span>\n<span class=\"line\"><span>    // 定义没有请求体和响应体的接口，如 ping</span></span>\n<span class=\"line\"><span>    @handler ping</span></span>\n<span class=\"line\"><span>    get /ping</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    // 定义只有请求体的接口，如更新信息</span></span>\n<span class=\"line\"><span>    @handler update</span></span>\n<span class=\"line\"><span>    post /update (UpdateReq)</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    // 定义只有响应体的结构，如获取全部信息列表</span></span>\n<span class=\"line\"><span>    @handler list</span></span>\n<span class=\"line\"><span>    get /list returns ([]ListItem)</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    // 定义有结构体和响应体的接口，如登录</span></span>\n<span class=\"line\"><span>    @handler login</span></span>\n<span class=\"line\"><span>    post /login (LoginReq) returns (LoginResp)</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    // 定义表单请求</span></span>\n<span class=\"line\"><span>    @handler formExample</span></span>\n<span class=\"line\"><span>    post /form/example (FormExampleReq)</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    // 定义 path 参数</span></span>\n<span class=\"line\"><span>    @handler pathExample</span></span>\n<span class=\"line\"><span>    get /path/example/:id (PathExampleReq) returns (PathExampleResp)</span></span>\n<span class=\"line\"><span>}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div></div><h3 id=\"生成代码\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#生成代码\"><span>生成代码</span></a></h3>\n<ul>\n<li>创建对应的<code v-pre>api</code>文件</li>\n<li>使用 <code v-pre>goctl api go --api {{api文件路径}} --dir {{生成文件目录}}</code></li>\n</ul>\n<h2 id=\"响应模板定义\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#响应模板定义\"><span>响应模板定义</span></a></h2>\n<p>使用 <code v-pre>goctl</code> 创建代码时，一般会使用对应的模板文件，默认是用户目录的 <code v-pre>.goctl</code> 目录中，从对应版本的文件夹进去，如果没有使用 <code v-pre>goctl template init</code> 来生成模板</p>\n<p>在创建响应的时候，我们一般是使用固定的返回格式，比如：</p>\n<div class=\"code-block-title\" data-title=\"响应示例.json\"><div class=\"code-block-title-bar\"><span class=\"title\"><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-json\"/>响应示例.json</span></div><div class=\"language-json line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"json\" style=\"--shiki-light:#4c4f69;--shiki-dark:#c6d0f5;--shiki-light-bg:#eff1f5;--shiki-dark-bg:#303446\"><pre class=\"shiki shiki-themes catppuccin-latte catppuccin-frappe vp-code\" v-pre=\"\"><code class=\"language-json\"><span class=\"line\"><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">  \"</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">code</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">\"</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">:</span><span style=\"--shiki-light:#FE640B;--shiki-dark:#EF9F76\"> 0</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">  \"</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">data</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">\"</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">:</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\"> {},</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">  \"</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">msg</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">\"</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">:</span><span style=\"--shiki-light:#40A02B;--shiki-dark:#A6D189\"> \"成功\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div></div><p>如果我们直接使用 <code v-pre>api</code> 文件定义，需要每次都编写 <code v-pre>code</code> 和 <code v-pre>msg</code> 这个固定类型，我们可以使用官方扩展的 <code v-pre>x</code> 包，也可以自定义一下响应，这里使用官方的 <code v-pre>x</code> 包，你需要使用 <code v-pre>go get github.com/zeromicro/x</code> 安装</p>\n<p>接下来，我们还有问题，这个配置文件在我们自己的用户目录，如果别人拿到项目，没有这个文件就不行，生成出来会不一样，所以我们还需要放在项目中，更好使用</p>\n<p>以下是整个操作的具体步骤：</p>\n<ul>\n<li>使用 <code v-pre>goctl template init</code> 初始化模板文件，文件生成到 <code v-pre>~/.goctl/{version}</code> 下面</li>\n<li>在项目中创建一个 <code v-pre>templates</code> 文件夹，名字可自定义</li>\n<li>将生成的所有模板文件，放到项目的 <code v-pre>templates</code> 文件夹下</li>\n<li>修改 <code v-pre>handle.tpl</code> 文件，这是用于生成 <code v-pre>handle</code> 代码的模板</li>\n<li>修改内容如下：</li>\n</ul>\n<div class=\"code-block-title\" data-title=\"模板内容.go\"><div class=\"code-block-title-bar\"><span class=\"title\"><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\"/>模板内容.go</span></div><div class=\"language-go line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"go\" style=\"--shiki-light:#4c4f69;--shiki-dark:#c6d0f5;--shiki-light-bg:#eff1f5;--shiki-dark-bg:#303446\"><pre class=\"shiki shiki-themes catppuccin-latte catppuccin-frappe vp-code\" v-pre=\"\"><code class=\"language-go\"><span class=\"line\"><span style=\"--shiki-light:#8839EF;--shiki-dark:#CA9EE6\">package</span><span style=\"--shiki-light:#DF8E1D;--shiki-light-font-style:italic;--shiki-dark:#E5C890;--shiki-dark-font-style:italic\"> {{.PkgName}}</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#8839EF;--shiki-dark:#CA9EE6\">import</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\"> (</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#40A02B;--shiki-dark:#A6D189\">\t\"net/http\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">\txhttp </span><span style=\"--shiki-light:#40A02B;--shiki-dark:#A6D189\">\"github.com/zeromicro/x/http\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#40A02B;--shiki-dark:#A6D189\">\t\"github.com/zeromicro/go-zero/rest/httpx\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">\t{{.ImportPackages}}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">{{if .HasDoc}}{{.Doc}}{{end}}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#8839EF;--shiki-dark:#CA9EE6\">func</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\"> {{.HandlerName}}</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(</span><span style=\"--shiki-light:#E64553;--shiki-light-font-style:italic;--shiki-dark:#EA999C;--shiki-dark-font-style:italic\">svcCtx</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\"> *</span><span style=\"--shiki-light:#DF8E1D;--shiki-light-font-style:italic;--shiki-dark:#E5C890;--shiki-dark-font-style:italic\">svc</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#DF8E1D;--shiki-light-font-style:italic;--shiki-dark:#E5C890;--shiki-dark-font-style:italic\">ServiceContext</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">)</span><span style=\"--shiki-light:#DF8E1D;--shiki-light-font-style:italic;--shiki-dark:#E5C890;--shiki-dark-font-style:italic\"> http</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#DF8E1D;--shiki-light-font-style:italic;--shiki-dark:#E5C890;--shiki-dark-font-style:italic\">HandlerFunc</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#8839EF;--shiki-dark:#CA9EE6\">\treturn</span><span style=\"--shiki-light:#8839EF;--shiki-dark:#CA9EE6\"> func</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(</span><span style=\"--shiki-light:#E64553;--shiki-light-font-style:italic;--shiki-dark:#EA999C;--shiki-dark-font-style:italic\">w</span><span style=\"--shiki-light:#DF8E1D;--shiki-light-font-style:italic;--shiki-dark:#E5C890;--shiki-dark-font-style:italic\"> http</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#DF8E1D;--shiki-light-font-style:italic;--shiki-dark:#E5C890;--shiki-dark-font-style:italic\">ResponseWriter</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">,</span><span style=\"--shiki-light:#E64553;--shiki-light-font-style:italic;--shiki-dark:#EA999C;--shiki-dark-font-style:italic\"> r</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\"> *</span><span style=\"--shiki-light:#DF8E1D;--shiki-light-font-style:italic;--shiki-dark:#E5C890;--shiki-dark-font-style:italic\">http</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#DF8E1D;--shiki-light-font-style:italic;--shiki-dark:#E5C890;--shiki-dark-font-style:italic\">Request</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">)</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">\t\t{{if .HasRequest}}var req types</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">{{.RequestType}}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#8839EF;--shiki-dark:#CA9EE6\">\t\tif</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> err </span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">:=</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> httpx</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">Parse</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">r</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">,</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\"> &#x26;</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">req</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">);</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> err </span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">!=</span><span style=\"--shiki-light:#D20F39;--shiki-dark:#E78284\"> nil</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">\t\t\txhttp</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">JsonBaseResponseCtx</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">r</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">Context</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(),</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> w</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">,</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> err</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#8839EF;--shiki-dark:#CA9EE6\">\t\t\treturn</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">\t\t}</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">\t\t{{end}}l </span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">:=</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> {{.LogicName}}</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">New{{.LogicType}}</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">r</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">Context</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(),</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> svcCtx</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">\t\t{{if .HasResp}}resp</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">,</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> {{end}}err </span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">:=</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> l</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">{{.Call}}</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">{{if .HasRequest}}</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">&#x26;</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">req{{end}}</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#8839EF;--shiki-dark:#CA9EE6\">\t\tif</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> err </span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">!=</span><span style=\"--shiki-light:#D20F39;--shiki-dark:#E78284\"> nil</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">\t\t\txhttp</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">JsonBaseResponseCtx</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">r</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">Context</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(),</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> w</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">,</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> err</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">\t\t}</span><span style=\"--shiki-light:#8839EF;--shiki-dark:#CA9EE6\"> else</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">\t\t\t{{if .HasResp}}xhttp</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">JsonBaseResponseCtx</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">r</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">Context</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(),</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> w</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">,</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> resp</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">)</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">{{else}}httpx</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">Ok</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">w</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">)</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">{{end}}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">\t\t}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">\t}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div></div><ul>\n<li>使用 <code v-pre>api</code> 文件生成代码，使用 <code v-pre>--home</code> 参数指定使用项目 <code v-pre>templates</code> 文件夹下的模板：</li>\n</ul>\n<div class=\"language-powershell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"powershell\" style=\"--shiki-light:#4c4f69;--shiki-dark:#c6d0f5;--shiki-light-bg:#eff1f5;--shiki-dark-bg:#303446\"><pre class=\"shiki shiki-themes catppuccin-latte catppuccin-frappe vp-code\" v-pre=\"\"><code class=\"language-powershell\"><span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">goctl api go </span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">--</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">api {{api文件路径}} </span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">--</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">dir {{生成的文件夹路径}} </span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">--</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">home .\\templates</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><h2 id=\"swagger-文档\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#swagger-文档\"><span>Swagger 文档</span></a></h2>\n<p><code v-pre>api</code> 文件配置可参照官方：https://go-zero.dev/docs/tutorials/cli/swagger</p>\n<h3 id=\"集成到服务中\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#集成到服务中\"><span>集成到服务中</span></a></h3>\n<ul>\n<li>在项目中创建一个目录 <code v-pre>doc</code> 或者 <code v-pre>static</code> 都行</li>\n<li>使用 <code v-pre>goctl api swagger --api {{api文件路径}} --dir ./doc</code> 生成文件到指定的目录</li>\n<li>在新建的目录创建 <code v-pre>swagger.html</code> 文件，<code v-pre>json</code> 文件和 <code v-pre>html</code> 文件同一个目录，不同需要指定好路径，在 <code v-pre>html</code> 添加如下代码：</li>\n</ul>\n<div class=\"code-block-title\" data-title=\"swagger.html\"><div class=\"code-block-title-bar\"><span class=\"title\"><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-html\"/>swagger.html</span></div><div class=\"language-html line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"html\" style=\"--shiki-light:#4c4f69;--shiki-dark:#c6d0f5;--shiki-light-bg:#eff1f5;--shiki-dark-bg:#303446\"><pre class=\"shiki shiki-themes catppuccin-latte catppuccin-frappe vp-code\" v-pre=\"\"><code class=\"language-html\"><span class=\"line\"><span style=\"--shiki-light:#8839EF;--shiki-dark:#CA9EE6\">&#x3C;!DOCTYPE</span><span style=\"--shiki-light:#DF8E1D;--shiki-dark:#E5C890\"> html</span><span style=\"--shiki-light:#8839EF;--shiki-dark:#CA9EE6\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">&#x3C;</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">html</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">  &#x3C;</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">head</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">    &#x3C;</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">title</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">Swagger UI</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">&#x3C;/</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">title</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">    &#x3C;</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">link</span><span style=\"--shiki-light:#DF8E1D;--shiki-dark:#E5C890\"> rel</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">=</span><span style=\"--shiki-light:#40A02B;--shiki-dark:#A6D189\">\"stylesheet\"</span><span style=\"--shiki-light:#DF8E1D;--shiki-dark:#E5C890\"> href</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">=</span><span style=\"--shiki-light:#40A02B;--shiki-dark:#A6D189\">\"https://unpkg.com/swagger-ui-dist@5/swagger-ui.css\"</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\"> /></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">  &#x3C;/</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">head</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">  &#x3C;</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">body</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">    &#x3C;</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">div</span><span style=\"--shiki-light:#DF8E1D;--shiki-dark:#E5C890\"> id</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">=</span><span style=\"--shiki-light:#40A02B;--shiki-dark:#A6D189\">\"swagger-ui\"</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">>&#x3C;/</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">div</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">    &#x3C;</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">script</span><span style=\"--shiki-light:#DF8E1D;--shiki-dark:#E5C890\"> src</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">=</span><span style=\"--shiki-light:#40A02B;--shiki-dark:#A6D189\">\"https://unpkg.com/swagger-ui-dist@5/swagger-ui-bundle.js\"</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">&#x3C;</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">/</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">script</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">    &#x3C;</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">script</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">      SwaggerUIBundle</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">(</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">        url</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">:</span><span style=\"--shiki-light:#40A02B;--shiki-dark:#A6D189\"> \"./main.json\"</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">,</span><span style=\"--shiki-light:#7C7F93;--shiki-light-font-style:italic;--shiki-dark:#949CBB;--shiki-dark-font-style:italic\"> // 确保路径正确</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">        dom_id</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">:</span><span style=\"--shiki-light:#40A02B;--shiki-dark:#A6D189\"> '#swagger-ui'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">      }</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">)</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">    &#x3C;</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">/</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">script</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">  &#x3C;/</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">body</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">&#x3C;/</span><span style=\"--shiki-light:#1E66F5;--shiki-dark:#8CAAEE\">html</span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">></span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div></div><ul>\n<li>进入主启动文件，获取当前的路径</li>\n</ul>\n<div class=\"code-block-title\" data-title=\"main.go\"><div class=\"code-block-title-bar\"><span class=\"title\"><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\"/>main.go</span></div><div class=\"language-go line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"go\" style=\"--shiki-light:#4c4f69;--shiki-dark:#c6d0f5;--shiki-light-bg:#eff1f5;--shiki-dark-bg:#303446\"><pre class=\"shiki shiki-themes catppuccin-latte catppuccin-frappe vp-code\" v-pre=\"\"><code class=\"language-go\"><span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">fs </span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">:=</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> http</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">Dir</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(</span><span style=\"--shiki-light:#40A02B;--shiki-dark:#A6D189\">\"./doc\"</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">)</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div></div><ul>\n<li>在定义 <code v-pre>server</code> 的代码中，加入静态文件服务</li>\n</ul>\n<div class=\"code-block-title\" data-title=\"main.go\"><div class=\"code-block-title-bar\"><span class=\"title\"><VPIcon provider=\"iconify\" name=\"vscode-icons:file-type-go\"/>main.go</span></div><div class=\"language-go line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"go\" style=\"--shiki-light:#4c4f69;--shiki-dark:#c6d0f5;--shiki-light-bg:#eff1f5;--shiki-dark-bg:#303446\"><pre class=\"shiki shiki-themes catppuccin-latte catppuccin-frappe vp-code\" v-pre=\"\"><code class=\"language-go\"><span class=\"line\"><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">server </span><span style=\"--shiki-light:#179299;--shiki-dark:#81C8BE\">:=</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> rest</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">MustNewServer</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">c</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\">RestConf</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">,</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> rest</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">.</span><span style=\"--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#8CAAEE;--shiki-dark-font-style:italic\">WithFileServer</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">(</span><span style=\"--shiki-light:#40A02B;--shiki-dark:#A6D189\">\"/static/\"</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">,</span><span style=\"--shiki-light:#4C4F69;--shiki-dark:#C6D0F5\"> fs</span><span style=\"--shiki-light:#7C7F93;--shiki-dark:#949CBB\">))</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div></div><ul>\n<li>启动服务，查看地址：<code v-pre>http://127.0.0.1:8888/doc/swagger.html</code></li>\n</ul>\n","tagOpen":"<template>","tagClose":"</template>"},"script":null,"scriptSetup":null,"scripts":[],"styles":[],"customBlocks":[]},"content":"## 项目基础结构\n\n:::tip\n项目结构未使用微服务架构，以目前个人的项目来\n:::\n\n:::file-tree\n- api // 存放 api 文件\n  - user.api\n- const // 一些常量\n  - ec // 存放错误枚举\n    - common.go\n    - user.go\n- docs // 文档内容\n  - main.json // goctl 生成的swagger数据\n  - swagger.html  // 自定义随项目启动的文件\n- etc // 由 goctl 生成，为配置文件\n  - main.yaml\n- http // 相关 http 后缀文件， 用于接口请求测试\n  - login.http\n- internal // goctl 生成，包含各类逻辑等文件\n  - config\n    - config.go\n  - handler\n    - user\n      - getuserinfohandler.go\n      - userloginhandler.go\n    - routes.go\n  - logic\n    - user\n      - getuserinfologic.go\n      - userloginlogic.go\n  - svc\n    - servicecontext.go\n  - types\n    - types.go\n- model //数据库文件\n  - user.go\n- templates // 存放自定义的 goctl 模板文件\n  - api\n    - ...\n  - docker\n    - ...\n  - geteway\n    - ...\n  - kube\n    - ...\n  - model\n    - ...\n  - mongo\n    - ...\n  - newapi\n    - ...\n  - rpc\n    - ...\n- utils // 自定义功能\n  - init_db.go\n  - jwt.go\n- Dockerfile\n- README.md\n- go.mod\n- go.sum\n- main.go\n:::\n\n## 生成api代码\n\n### api 文件基本使用\n\n> [!important]\n> 使用 `goctl api go ` 来生成代码，会跳过已经生成的文件，所以如果新增接口、类型，需要删除无需手动编辑的文件，如 `types` 目录、主文件（路由注册）等，这个代表生成的类型等，即需要重新生成的删除，不需要的保留\n>\n> 比如一个 `user` 服务，你修改了某个接口的类型和接口定义，你需要删除 `handler` 、`types` ，然后重新执行 `goctl api go` 的命令，`logic` 逻辑代码已经改过，不要删除，精准情况下，只删除对应的文件也行\n\n> [!important]\n> `api` 文件中，只能有对应名称的 `service` ，创建多个 `service` 必须是同名的，即使使用 `import` 导入其他 `api` 文件也不行\n\n> [!important]\n> 在 `api` 文件中，可以在 `@server` 中指定 `group` 参数，生成的 `logic` 和 `handler` 可以使用不同的文件夹存在，可以进行不同分类\n\n在你的项目目标文件夹中，创建一个 `api` 文件，也可以使用 `goctl api template -o {{目标文件夹}}\\{{文件名}}.api` 来生成一个 `api` 文件\n\n官方示例：\n\n```text title=\"api文件\"\nsyntax = \"v1\"\n\n// 这里的主要用在 swagger 文件显示\ninfo (\n    title:   \"api 文件完整示例写法\"\n    desc:    \"演示如何编写 api 文件\"\n    author:  \"keson.an\"\n    date:    \"2022 年 12 月 26 日\"\n    version: \"v1\"\n)\n\n// 使用 type 定义请求结构体\n\ntype UpdateReq {\n    Arg1 string `json:\"arg1\"`\n}\n\ntype ListItem {\n    Value1 string `json:\"value1\"`\n}\n\n// 可以使用 example 在生成 swagger 时给出一些数据的示例\ntype LoginReq {\n    Username string `json:\"username,example=username\"`\n    Password string `json:\"password,example=123456\"`\n}\n\n// 如果需要字段可选，就需要加上 optional 标记\ntype LoginResp {\n    Name string `json:\"name,optional\"`\n}\n\ntype FormExampleReq {\n    Name string `form:\"name\"`\n}\n\ntype PathExampleReq {\n    // path 标签修饰的 id 必须与请求路由中的片段对应，如\n    // id 在 service 语法块的请求路径上一定会有 :id 对应，见下文。\n    ID string `path:\"id\"`\n}\n\ntype PathExampleResp {\n    Name string `json:\"name\"`\n}\n\n// 这里定义的 @server 针对下面的 service ，如果有其他的，就在其他 service 上面定义 @server\n@server (\n    jwt:        Auth // 对当前 Foo 语法块下的所有路由，开启 jwt 认证，不需要则请删除此行\n    prefix:     /v1 // 对当前 Foo 语法块下的所有路由，新增 /v1 路由前缀，不需要则请删除此行\n    group:      g1 // 对当前 Foo 语法块下的所有路由，路由归并到 g1 目录下，不需要则请删除此行\n    timeout:    3s // 对当前 Foo 语法块下的所有路由进行超时配置，不需要则请删除此行\n    middleware: AuthInterceptor // 对当前 Foo 语法块下的所有路由添加中间件，不需要则请删除此行\n    maxBytes:   1048576 // 对当前 Foo 语法块下的所有路由添加请求体大小控制，单位为 byte,goctl 版本 >= 1.5.0 才支持\n)\n\n// 这里是定义的接口\nservice Foo {\n    // 定义没有请求体和响应体的接口，如 ping\n    @handler ping\n    get /ping\n\n    // 定义只有请求体的接口，如更新信息\n    @handler update\n    post /update (UpdateReq)\n\n    // 定义只有响应体的结构，如获取全部信息列表\n    @handler list\n    get /list returns ([]ListItem)\n\n    // 定义有结构体和响应体的接口，如登录\n    @handler login\n    post /login (LoginReq) returns (LoginResp)\n\n    // 定义表单请求\n    @handler formExample\n    post /form/example (FormExampleReq)\n\n    // 定义 path 参数\n    @handler pathExample\n    get /path/example/:id (PathExampleReq) returns (PathExampleResp)\n}\n\n```\n\n### 生成代码\n- 创建对应的`api`文件\n- 使用 `goctl api go --api {{api文件路径}} --dir {{生成文件目录}}`\n\n## 响应模板定义\n\n使用 `goctl` 创建代码时，一般会使用对应的模板文件，默认是用户目录的 `.goctl` 目录中，从对应版本的文件夹进去，如果没有使用 `goctl template init` 来生成模板\n\n在创建响应的时候，我们一般是使用固定的返回格式，比如：\n\n```json title=\"响应示例.json\"\n{\n  \"code\": 0,\n  \"data\": {},\n  \"msg\": \"成功\"\n}\n```\n\n如果我们直接使用 `api` 文件定义，需要每次都编写 `code` 和 `msg` 这个固定类型，我们可以使用官方扩展的 `x` 包，也可以自定义一下响应，这里使用官方的 `x` 包，你需要使用 `go get github.com/zeromicro/x` 安装\n\n接下来，我们还有问题，这个配置文件在我们自己的用户目录，如果别人拿到项目，没有这个文件就不行，生成出来会不一样，所以我们还需要放在项目中，更好使用\n\n以下是整个操作的具体步骤：\n\n- 使用 `goctl template init` 初始化模板文件，文件生成到 `~/.goctl/{version}` 下面\n- 在项目中创建一个 `templates` 文件夹，名字可自定义\n- 将生成的所有模板文件，放到项目的 `templates` 文件夹下\n- 修改 `handle.tpl` 文件，这是用于生成 `handle` 代码的模板\n- 修改内容如下：\n\n```go title=\"模板内容.go\"\npackage {{.PkgName}}\n\nimport (\n\t\"net/http\"\n\txhttp \"github.com/zeromicro/x/http\"\n\t\"github.com/zeromicro/go-zero/rest/httpx\"\n\t{{.ImportPackages}}\n)\n\n{{if .HasDoc}}{{.Doc}}{{end}}\nfunc {{.HandlerName}}(svcCtx *svc.ServiceContext) http.HandlerFunc {\n\treturn func(w http.ResponseWriter, r *http.Request) {\n\t\t{{if .HasRequest}}var req types.{{.RequestType}}\n\t\tif err := httpx.Parse(r, &req); err != nil {\n\t\t\txhttp.JsonBaseResponseCtx(r.Context(), w, err)\n\t\t\treturn\n\t\t}\n\n\t\t{{end}}l := {{.LogicName}}.New{{.LogicType}}(r.Context(), svcCtx)\n\t\t{{if .HasResp}}resp, {{end}}err := l.{{.Call}}({{if .HasRequest}}&req{{end}})\n\t\tif err != nil {\n\t\t\txhttp.JsonBaseResponseCtx(r.Context(), w, err)\n\t\t} else {\n\t\t\t{{if .HasResp}}xhttp.JsonBaseResponseCtx(r.Context(), w, resp){{else}}httpx.Ok(w){{end}}\n\t\t}\n\t}\n}\n```\n\n- 使用 `api` 文件生成代码，使用 `--home` 参数指定使用项目 `templates` 文件夹下的模板：\n\n```powershell\ngoctl api go --api {{api文件路径}} --dir {{生成的文件夹路径}} --home .\\templates\n```\n\n## Swagger 文档\n`api` 文件配置可参照官方：https://go-zero.dev/docs/tutorials/cli/swagger\n\n### 集成到服务中\n\n- 在项目中创建一个目录 `doc` 或者 `static` 都行\n- 使用 `goctl api swagger --api {{api文件路径}} --dir ./doc` 生成文件到指定的目录\n- 在新建的目录创建 `swagger.html` 文件，`json` 文件和 `html` 文件同一个目录，不同需要指定好路径，在 `html` 添加如下代码：\n\n```html title=\"swagger.html\"\n<!DOCTYPE html>\n<html>\n  <head>\n    <title>Swagger UI</title>\n    <link rel=\"stylesheet\" href=\"https://unpkg.com/swagger-ui-dist@5/swagger-ui.css\" />\n  </head>\n  <body>\n    <div id=\"swagger-ui\"></div>\n    <script src=\"https://unpkg.com/swagger-ui-dist@5/swagger-ui-bundle.js\"></script>\n    <script>\n      SwaggerUIBundle({\n        url: \"./main.json\", // 确保路径正确\n        dom_id: '#swagger-ui'\n      });\n    </script>\n  </body>\n</html>\n```\n\n- 进入主启动文件，获取当前的路径\n\n```go title=\"main.go\"\nfs := http.Dir(\"./doc\")\n```\n\n- 在定义 `server` 的代码中，加入静态文件服务\n\n```go title=\"main.go\"\nserver := rest.MustNewServer(c.RestConf, rest.WithFileServer(\"/static/\", fs))\n```\n\n- 启动服务，查看地址：`http://127.0.0.1:8888/doc/swagger.html`","excerpt":"","includedFiles":[],"tasklistId":0,"title":"","headers":[{"level":2,"title":"项目基础结构","slug":"项目基础结构","link":"#项目基础结构","children":[]},{"level":2,"title":"生成api代码","slug":"生成api代码","link":"#生成api代码","children":[{"level":3,"title":"api 文件基本使用","slug":"api-文件基本使用","link":"#api-文件基本使用","children":[]},{"level":3,"title":"生成代码","slug":"生成代码","link":"#生成代码","children":[]}]},{"level":2,"title":"响应模板定义","slug":"响应模板定义","link":"#响应模板定义","children":[]},{"level":2,"title":"Swagger 文档","slug":"swagger-文档","link":"#swagger-文档","children":[{"level":3,"title":"集成到服务中","slug":"集成到服务中","link":"#集成到服务中","children":[]}]}]}}
